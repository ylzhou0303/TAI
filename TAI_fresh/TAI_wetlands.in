# Description: Simple microbial decomposition and dissolution to DOM network
# Rate constants estimated to show different processes

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE GENERAL
      OPTIONS
        #ARITHMETIC_GAS_DIFFUSIVE_DENSITY
      /
    /
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
      #NUMERICAL_JACOBIAN
    /
  /
END

SUBSURFACE

#=========================== useful transport parameters =======================

REFERENCE_LIQUID_DENSITY 1.d3


#=========================== chemistry ========================================
CHEMISTRY
PRIMARY_SPECIES
  #### NOTE: Beginning of auto-inserted primary species ####
  DOM1
  H+
  O2(aq)
  HCO3-
  NH4+
  Fe+++
  Fe++
  Tracer
  Tracer1
  CH4(aq)
  SO4--
  H2S(aq)
  #### NOTE: End of auto-inserted primary species ####
/
DECOUPLED_EQUILIBRIUM_REACTIONS
  #### NOTE: Beginning of auto-inserted primary species ####
  DOM1
  H+
  O2(aq)
  HCO3-
  Fe+++
  Fe++
  NH4+
  Tracer
  CH4(aq)
  H2S(aq)
  #### NOTE: End of auto-inserted primary species ####
/
SECONDARY_SPECIES
  #### NOTE: Beginning of auto-inserted secondary species ####
  CO2(aq)
  OH-
  FeCO3+
  #### NOTE: End of auto-inserted secondary species ####
/
MINERALS
  #### NOTE: Beginning of auto-inserted secondary species ####
  Fe(OH)3
  FeO
  #### NOTE: End of auto-inserted secondary species ####
/
MINERAL_KINETICS
  #### NOTE: Beginning of auto-inserted secondary species ####
  Fe(OH)3
    RATE_CONSTANT  1.d-7 mol/m^2-sec
  /
  FeO
    RATE_CONSTANT  1.d-7 mol/m^2-sec
  /
  #### NOTE: End of auto-inserted secondary species ####
/
IMMOBILE_SPECIES
  #### NOTE: Beginning of auto-inserted immobile species ####
  cellulose
  HRimm
  microbes1
  microbes2
  microbes3
  microbes4
  microbes5

  #### NOTE: End of auto-inserted immobile species ####
/
PASSIVE_GAS_SPECIES
  #### NOTE: Beginning of auto-inserted gas species ####
  CO2(g)
  O2(g)
  #### NOTE: End of auto-inserted gas species ####
/




#### NOTE: Beginning of auto-inserted reactions ####
  #DOM Aerobic RESPIRATION
 MICROBIAL_REACTION
    REACTION DOM1 + 1.0 O2(aq) -> 1.0 HCO3- + 1.0 H+ + 1.d-1 NH4+
    RATE_CONSTANT 1.d-11   #unit: mol L-1 s-1 (mol m3 biomass)-1

    MONOD
      SPECIES_NAME O2(aq)
      HALF_SATURATION_CONSTANT 2.5d-5   
    /

    
    MONOD
      SPECIES_NAME DOM1
      HALF_SATURATION_CONSTANT 5.d-4  
    /
    

    BIOMASS
      SPECIES_NAME microbes1
      YIELD 0.01d0   #the portion of the energy transfered to microbes to support the growth of microbes
    /
  /




#Methanogenesis DOM1
  MICROBIAL_REACTION 
    REACTION 2.d0 DOM1 -> 1.d0 CH4(aq) + 1.d0 HCO3- + 1.d0 H+ + 1.d-1 NH4+
    #it is the combination of aceticlastic and hydrogenotrophic methanogenesis, DOM1 is counted as the moles of carbon
    
    RATE_CONSTANT 9.d-13 # Weston 2014, mol L-1 s-1 (mol m3 biomass)-1, corrected for the microbial abundance from 9.d-11 mol L-1 s-1
    
    MONOD
      SPECIES_NAME DOM1
      HALF_SATURATION_CONSTANT 5.d-4
    /
   

    BIOMASS
      SPECIES_NAME microbes2
      YIELD 0.01d0
    /
   
 /
 

#Methane oxidation - O2
  MICROBIAL_REACTION 
    REACTION CH4(aq) + O2(aq) -> HCO3- + H2O + H+ + Tracer
    
    RATE_CONSTANT 1.6d-12                 
    
    
    MONOD
      SPECIES_NAME O2(aq)
      HALF_SATURATION_CONSTANT 2.5d-5  
    /

    MONOD
      SPECIES_NAME CH4(aq)
      HALF_SATURATION_CONSTANT 6.d-5  
    /

    BIOMASS
      SPECIES_NAME microbes3
      YIELD 0.01d0
    /
  /

  


#Sulfate reduction DOM1
  MICROBIAL_REACTION 
    REACTION 2.d0 DOM1 + 1.d0 SO4-- -> 2.d0 HCO3- + 1.d0 H2S(aq) + 1.d-1 NH4+
   
    RATE_CONSTANT 2.26d-11   #Weston 2014
   
    MONOD
      SPECIES_NAME SO4--
      HALF_SATURATION_CONSTANT 5.d-4    #based on the SO4-- concentration
    /

    skip     #In Furukawa 2014, there was no Monod term for DOM
    MONOD
      SPECIES_NAME DOM1
      HALF_SATURATION_CONSTANT 3.d-3    
    /
    noskip
    
    BIOMASS
      SPECIES_NAME microbes4
      YIELD 0.01d0
    /
  /




#Sulfide oxidation
  MICROBIAL_REACTION 
    REACTION 1.d0 H2S(aq) + 2.d0 O2(aq) -> 1.d0 SO4-- + 2.d0 H+ 
    
    RATE_CONSTANT 1.6d-11 #mol-m3 bulk/(L water-mol biomass-sec)
    
    MONOD
      SPECIES_NAME O2(aq)
      HALF_SATURATION_CONSTANT 2.5d-5
    /

    MONOD
      SPECIES_NAME H2S(aq)
      HALF_SATURATION_CONSTANT 6.d-5 
    /
    
    BIOMASS
      SPECIES_NAME microbes5
      YIELD 0.01d0
    /
  /




# DOM recharge throughout the whole soil column
MICROBIAL_REACTION 
    REACTION Tracer -> DOM1 
    
    RATE_CONSTANT 0.9d-8     # unit: mol L-1 s-1
    
    
    MONOD
      SPECIES_NAME  Tracer
      HALF_SATURATION_CONSTANT   0.1
    /      
  /




# SO4-- recharge throughout the whole soil column
MICROBIAL_REACTION 
    REACTION Tracer -> SO4-- 
    
    RATE_CONSTANT 3.d-9     # unit: mol L-1 s-1
    
    
    MONOD
      SPECIES_NAME  Tracer
      HALF_SATURATION_CONSTANT   0.1
    /      
  /

skip
# CH4 and H2S removal from the top
MICROBIAL_REACTION 
    REACTION CH4(aq) + H2S(aq) + Tracer -> Tracer1
    
    RATE_CONSTANT 5.d-11     # unit: mol L-1 s-1

    MONOD
      SPECIES_NAME  Tracer
      HALF_SATURATION_CONSTANT   0.1
    /    
  /
noskip


#### NOTE: End of auto-inserted reactions ####

  TRUNCATE_CONCENTRATION 1.d-80


  LOG_FORMULATION
  DATABASE ./hanford.dat

  OUTPUT
    !PH
    
    TOTAL
      O2(aq)
      CH4(aq)
      DOM1
      SO4--
      H2S(aq)
     
    #FREE_ION
    #PRIMARY_SPECIES
    #SECONDARY_SPECIES
    #GASES
    #MINERALS
    #IMMOBILE
      #microbes1
      #microbes2
      #microbes3
      #microbes4
      #microbes5
 

  /
END

#=========================== transport constraints ============================
CONSTRAINT initial
  IMMOBILE
    #### NOTE: Beginning of auto-inserted immobile species ####
    cellulose            1.0e+03
    HRimm                1.0e-20
    microbes1             100.d0    # mol-C/m3  of microbial biomass, not mols of cell counts, ballpark range from Steinmuller et al. 2019
    microbes2             100.d0
    microbes3             100.d0
    microbes4             100.d0
    microbes5             100.d0
    #### NOTE: End of auto-inserted immobile species ####
  /
  CONCENTRATIONS
    #### NOTE: Beginning of auto-inserted concentration constraints ####
    DOM1                6.0e-3 T
    H+                  5.9 P 
    O2(aq)              2.d-6 T           
    #the initial concentration of O2 for the soil porewater; it should not be higher than 2e-4, otherwise it cause problems 
    HCO3-               400e-6 G CO2(g)
    Fe+++               0.37e-3 M Fe(OH)3
    Fe++                0.37e-10
    NH4+                1.0e-6
    Tracer              0.1
    Tracer1             0.1
    CH4(aq)             6.0e-4          #from measured data at typha
    SO4--               5.d-3
    H2S(aq)             3.d-4
    #### NOTE: End of auto-inserted concentration constraints ####
  /
  MINERALS
    #### NOTE: Beginning of auto-inserted mineral constraints ####
    Fe(OH)3             1.d-5  1.e2 m^2/m^3
    FeO                 0.0  1. m^2/m^3
    #### NOTE: End of auto-inserted mineral constraints ####
  /  
END



CONSTRAINT sed_air_interface
  IMMOBILE
    #### NOTE: Beginning of auto-inserted immobile species ####
    cellulose            1.0e+03
    HRimm                1.0e-20
    microbes1             100.d0
    microbes2             100.d0
    microbes3             100.d0
    microbes4             100.d0
    microbes5             100.d0
    #### NOTE: End of auto-inserted immobile species ####
  /
  CONCENTRATIONS
    #### NOTE: Beginning of auto-inserted concentration constraints ####
    DOM1                6.e-3
    H+                  5.9 P
    O2(aq)              2.5d-4 T        #sed_air_interface, when fully inundated, set to be 10% saturated with O2
    HCO3-               400e-6 G CO2(g)
    Fe+++               0.37e-3 M Fe(OH)3
    Fe++                0.37e-10
    NH4+                1.0e-15
    Tracer              1.0e-15
    Tracer1             1.0e-15
    CH4(aq)             1.0e-20
    SO4--               5.d-3
    H2S(aq)             1.d-20
    #### NOTE: End of auto-inserted concentration constraints ####
  /
  MINERALS
    #### NOTE: Beginning of auto-inserted mineral constraints ####
    Fe(OH)3             1.d-5  1.e2 m^2/m^3
    FeO                 0.0  1. m^2/m^3
    #### NOTE: End of auto-inserted mineral constraints ####
  /  
END

CONSTRAINT O2_diffusion
  IMMOBILE
    #### NOTE: Beginning of auto-inserted immobile species ####
    cellulose            1.0e+03
    HRimm                1.0e-20
    microbes1             100.d0
    microbes2             100.d0
    microbes3             100.d0
    microbes4             100.d0
    microbes5             100.d0
    #### NOTE: End of auto-inserted immobile species ####
  /
  CONCENTRATIONS
    #### NOTE: Beginning of auto-inserted concentration constraints ####
    DOM1                1.e-20
    H+                  5.9 P
    O2(aq)              4.d0 T        #sed_air_interface, when fully inundated, set to be 10% saturated with O2
    HCO3-               400e-6 G CO2(g)
    Fe+++               0.37e-3 M Fe(OH)3
    Fe++                0.37e-10
    NH4+                1.0e-15
    Tracer              1.0e-15
    Tracer1             1.0e-15
    CH4(aq)             1.0e-20
    SO4--               5.d-3
    H2S(aq)             1.d-20
    #### NOTE: End of auto-inserted concentration constraints ####
  /
  MINERALS
    #### NOTE: Beginning of auto-inserted mineral constraints ####
    Fe(OH)3             1.d-5  1.e2 m^2/m^3
    FeO                 0.0  1. m^2/m^3
    #### NOTE: End of auto-inserted mineral constraints ####
  /  
END


CONSTRAINT bottom_boundary
  IMMOBILE
    #### NOTE: Beginning of auto-inserted immobile species ####
    cellulose            1.0e+03
    HRimm                1.0e-20
    microbes1             100.d0
    microbes2             100.d0
    microbes3             100.d0
    microbes4             100.d0
    microbes5             100.d0
    #### NOTE: End of auto-inserted immobile species ####
  /
  CONCENTRATIONS
    #### NOTE: Beginning of auto-inserted concentration constraints ####
    DOM1                1.e-2
    H+                  5.9 P
    O2(aq)              1.d-20 T        #bottom boundary, oxygen should be zero
    HCO3-               400e-6 G CO2(g)
    Fe+++               0.37e-3 M Fe(OH)3
    Fe++                0.37e-10
    NH4+                1.0e-15
    Tracer              1.0e-15
    Tracer1             1.0e-15
    CH4(aq)             2.d-4
    SO4--               5.d-3
    H2S(aq)             3.d-4
    #### NOTE: End of auto-inserted concentration constraints ####
  /
  MINERALS
    #### NOTE: Beginning of auto-inserted mineral constraints ####
    Fe(OH)3             1.d-5  1.e2 m^2/m^3
    FeO                 0.0  1. m^2/m^3
    #### NOTE: End of auto-inserted mineral constraints ####
  /  
END



CONSTRAINT root           #constraint of the location of roots, used for the boundary condition
  IMMOBILE
    #### NOTE: Beginning of auto-inserted immobile species ####
    cellulose            1.0e+03
    HRimm                1.0e-20
    microbes1             100.d0
    microbes2             100.d0
    microbes3             100.d0
    microbes4             100.d0
    microbes5             100.d0
    #### NOTE: End of auto-inserted immobile species ####
  /
  CONCENTRATIONS
    #### NOTE: Beginning of auto-inserted concentration constraints ####
    DOM1                1.e-20
    H+                  5.9 P
    O2(aq)              1.d0 T          #this number times the flow rate would be about 20 mmol m-2 d-1, the O2 injection rate       
    HCO3-               400e-6 G CO2(g)
    Fe+++               0.37e-3 M Fe(OH)3
    Fe++                0.37e-10
    NH4+                1.0e-15
    Tracer              1.0e-15
    Tracer1             1.0e-15
    CH4(aq)             1.0e-20
    SO4--               1.d-20
    H2S(aq)             1.d-20
    #### NOTE: End of auto-inserted concentration constraints ####
  /
  MINERALS
    #### NOTE: Beginning of auto-inserted mineral constraints ####
    Fe(OH)3             1.d-5  1.e2 m^2/m^3
    FeO                 0.0  1. m^2/m^3
    #### NOTE: End of auto-inserted mineral constraints ####
  /  
END


CONSTRAINT tide
  IMMOBILE
    #### NOTE: Beginning of auto-inserted immobile species ####
    cellulose            1.0e-20
    HRimm                1.0e-20
    microbes1             100.d0
    microbes2             100.d0
    microbes3             100.d0
    microbes4             100.d0
    microbes5             100.d0
    #### NOTE: End of auto-inserted immobile species ####
  /
  CONCENTRATIONS
    #### NOTE: Beginning of auto-inserted concentration constraints ####
    DOM1                1.0e-20
    H+                  1.0e-20
    O2(aq)              5.0e-5 T
    HCO3-               1.0e-20
    Fe+++               1.0e-20
    Fe++                1.0e-20
    NH4+                1.0e-20
    Tracer              1.0e-20
    Tracer1             1.0e-20
    CH4(aq)             1.0e-20
    SO4--               1.d-20
    H2S(aq)             1.d-20
    #### NOTE: End of auto-inserted concentration constraints ####
  /
  MINERALS
    #### NOTE: Beginning of auto-inserted mineral constraints ####
    Fe(OH)3             1.0e-20 1.0
    FeO                 1.0e-20 1.0
    #### NOTE: End of auto-inserted mineral constraints ####
  /

END



#=========================== solver options ===================================
NUMERICAL_METHODS TRANSPORT
  LINEAR_SOLVER
    SOLVER DIRECT
    !SOLVER ITERATIVE     ! default: ITERATIVE or KRYLOV: KSP_TYPE of BCGS and PC_TYPE of BJACOBI, if not modified below
    PC_TYPE JACOBI       ! default (iterative): BJACOBI. 
    KSP_TYPE fgmres      ! default: BCGS. NOT much difference 
  /

  NEWTON_SOLVER TRANSPORT
    NUMERICAL_JACOBIAN
    ATOL 1.d-20
    RTOL 1.d-15
    STOL 1.d-10
    ITOL 1.d-10
  /
END

#=========================== discretization ===================================
GRID
  TYPE structured
  ORIGIN 0.d0 0.d0 0.d0
  NXYZ 7 7 5

  
  DXYZ
    
    0.14d0\ 
    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0



    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0\
    0.14d0


    0.30d0\   #a total of 70cm deep soil cube
    0.20d0\
    0.10d0\
    0.05d0\
    0.05d0
    #0.001d0    #the top one is the boundary layer
  END


skip
  BOUNDS 
    0.d0 0.d0 0.d0
    1.d0 1.d0 1.d0   # 1m deep
  /
noskip
END


PROC 1 1 1

#=========================== fluid properties =================================
FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 5.d-9  #unit: m2/s   #Here I use oxygen diffusion coefficient in water (20C)

END

FLUID_PROPERTY
  PHASE GAS
  DIFFUSION_COEFFICIENT 2.d-5
END

#=========================== material properties ==============================
MATERIAL_PROPERTY soil1
  ID 1
  POROSITY 0.8d0
  SOIL_COMPRESSIBILITY_FUNCTION DEFAULT     ! BRAGFLO compressed porosity has mathematical issue at high pressure
  ! 1d-7~1d-8 equivalent to ice expansion of volume, upon 'default' or 'BRAGFLO'
  ! beyond this range may cause tiny-time stepping
  SOIL_COMPRESSIBILITY 1.d-07               ! 1d-7~1d-8 is a critical value for freezing expansion in soil;
  SOIL_REFERENCE_PRESSURE 201325.d0
  ROCK_DENSITY 2650.0d0
  SPECIFIC_HEAT 830.0d0
  THERMAL_CONDUCTIVITY_DRY 0.12037926674717922d0
  THERMAL_CONDUCTIVITY_WET 1.6082691464310437d0
  THERMAL_COND_EXPONENT 0.45d0
  THERMAL_CONDUCTIVITY_FROZEN 2.29d+00
  THERMAL_COND_EXPONENT_FROZEN 0.95d0
  CHARACTERISTIC_CURVES sf01
  PERMEABILITY
    PERM_X 1.d-11
    PERM_Y 1.d-11
    PERM_Z 1.d-11
  /
/


#=========================== characteristic curves ============================
CHARACTERISTIC_CURVES sf01
  SATURATION_FUNCTION VAN_GENUCHTEN
    LIQUID_RESIDUAL_SATURATION 0.d0
    ALPHA 1.d-4
    M 0.5d0
    MAX_CAPILLARY_PRESSURE 1.d6
  /
  PERMEABILITY_FUNCTION MUALEM
    PHASE LIQUID
    LIQUID_RESIDUAL_SATURATION 0.d0
    M 0.5d0
  /
  PERMEABILITY_FUNCTION MUALEM_VG_GAS
    PHASE GAS
    LIQUID_RESIDUAL_SATURATION 0.d0
    GAS_RESIDUAL_SATURATION 1.d-40
    M 0.5d0
  /
END



#=========================== output options ===================================
OUTPUT
  SCREEN PERIODIC 100
  PERIODIC TIME 24 hour          #the frequency of generating output
  FORMAT HDF5                #hdf5 file can be read by VISITS
  FORMAT TECPLOT POINT       #text file, can be read in python and plot data


  OBSERVATION_FILE      #generate results only for the observation points
    PERIODIC TIME  12 hour

  END


  VARIABLES
    LIQUID_SATURATION    
  END
  
 MASS_BALANCE_FILE
    PERIODIC TIME 1 day
  /

END

#=========================== times ============================================
TIME
  FINAL_TIME 30 day

  INITIAL_TIMESTEP_SIZE 0.5d0 h
  MAXIMUM_TIMESTEP_SIZE 12.d0 h
END

#=========================== regions ==========================================
REGION top
  COORDINATES
    0.d0     0.d0 0.7d0
    0.98d0 0.98d0 0.7d0
  /
  FACE TOP
END

REGION test
  COORDINATES
    0.d0     0.d0 0.6d0
    0.98d0 0.98d0 0.6d0
  /
  FACE TOP
END

REGION west
    COORDINATES
    0.d0   0.d0 0.d0
    0.49d0 1.d0 0.7d0
  /
  FACE TOP
END


REGION east
    COORDINATES
    0.49d0   0.d0   0.d0
    0.98d0   1.d0   0.7d0
  /
  FACE TOP
END



REGION top_layer
  COORDINATES
    0.d0 0.d0 0.625d0
    1.d0 1.d0 0.7d0
  /
  FACE TOP
END


REGION sec_layer
  COORDINATES
    0.d0 0.d0 0.575d0
    1.d0 1.d0 0.625d0
  /
  FACE TOP
END

REGION bottom
  COORDINATES
    0.d0 0.d0 0.0d0
    1.d0 1.d0 0.0d0
  /
  FACE BOTTOM
END


REGION all
  COORDINATES
    0.d0 0.d0 0.d0
    1.d0 1.d0 0.7d0
  /
  FACE TOP
END


REGION root1     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.77d0 0.91d0 0.6d0
    0.77d0 0.91d0 0.6d0
  /

  FACE BOTTOM
END

REGION root2     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.63d0 0.49d0 0.6d0
    0.63d0 0.49d0 0.6d0
  /

  FACE TOP
END

REGION root3     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.35d0 0.49d0 0.6d0
    0.35d0 0.49d0 0.6d0
  /

  FACE TOP
END

REGION root4     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.07d0 0.21d0 0.6d0
    0.07d0 0.21d0 0.6d0
  /

  FACE TOP
END


REGION root5     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.91d0 0.07d0 0.6d0
    0.91d0 0.07d0 0.6d0
  /

  FACE TOP
END


REGION root6     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.21d0 0.35d0 0.6d0
    0.21d0 0.35d0 0.6d0
  /

  FACE TOP
END


REGION root7     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.35d0 0.07d0 0.6d0
    0.35d0 0.07d0 0.6d0
  /

  FACE TOP
END


REGION root8     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.35d0 0.35d0 0.6d0
    0.35d0 0.35d0 0.6d0
  /

  FACE TOP
END


REGION root9     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.49d0 0.49d0 0.6d0
    0.49d0 0.49d0 0.6d0
  /

  FACE TOP
END



REGION root10     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.06d0 0.06d0 0.6d0
    0.07d0 0.07d0 0.6d0
  /

  FACE TOP
END


REGION root11     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.34d0 0.06d0 0.6d0
    0.35d0 0.07d0 0.6d0
  /

  FACE TOP
END


REGION root12     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.62d0 0.06d0 0.6d0
    0.63d0 0.07d0 0.6d0
  /

  FACE TOP
END


REGION root13     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.90d0 0.06d0 0.6d0
    0.91d0 0.07d0 0.6d0
  /

  FACE TOP
END



REGION root14     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.06d0 0.34d0 0.6d0
    0.07d0 0.35d0 0.6d0
  /

  FACE TOP
END


REGION root15     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.34d0 0.34d0 0.6d0
    0.35d0 0.35d0 0.6d0
  /

  FACE TOP
END


REGION root16     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.62d0 0.34d0 0.6d0
    0.63d0 0.35d0 0.6d0
  /

  FACE TOP
END


REGION root17     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.90d0 0.34d0 0.6d0
    0.91d0 0.35d0 0.6d0
  /

  FACE TOP
END


REGION root18     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.06d0 0.62d0 0.6d0
    0.07d0 0.63d0 0.6d0
  /

  FACE TOP
END


REGION root19     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.34d0 0.62d0 0.6d0
    0.35d0 0.63d0 0.6d0
  /

  FACE TOP
END



REGION root20     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.62d0 0.62d0 0.6d0
    0.63d0 0.63d0 0.6d0
  /

  FACE TOP
END

REGION root21     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.90d0 0.62d0 0.6d0
    0.91d0 0.63d0 0.6d0
  /

  FACE TOP
END


REGION root22     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.06d0 0.90d0 0.6d0
    0.07d0 0.91d0 0.6d0
  /

  FACE TOP
END

REGION root23     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.34d0 0.90d0 0.6d0
    0.35d0 0.91d0 0.6d0
  /

  FACE TOP
END

REGION root24     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.62d0 0.90d0 0.6d0
    0.63d0 0.91d0 0.6d0
  /

  FACE TOP
END


REGION root25     #where the rhizomes are, where O2 is transported into the soil by roots
    COORDINATES
    0.90d0 0.90d0 0.6d0
    0.91d0 0.91d0 0.6d0
  /

  FACE TOP
END

REGION obs_pt
  COORDINATE  0.5   0.5  0.25d0
  FACE TOP
/



#=========================== observation points ===============================
OBSERVATION
  REGION obs_pt
  AT_COORDINATE    # if not "AT_COORDINATE", then observation data sampled from the center of the cell (by default)
END


#=========================== transport conditions =============================
TRANSPORT_CONDITION initial
  TYPE dirichlet
  TIME_UNITS hr
  CONSTRAINT_LIST
    0.d0 initial 
  /
END


TRANSPORT_CONDITION sed_air_interface
  TYPE dirichlet
  TIME_UNITS hr
  CONSTRAINT_LIST
   0.d0 sed_air_interface
   
  /
END

TRANSPORT_CONDITION bottom_boundary
  TYPE dirichlet
  TIME_UNITS hr
  CONSTRAINT_LIST
   0.d0 bottom_boundary
   
  /
END



TRANSPORT_CONDITION root
  TYPE dirichlet
  TIME_UNITS hr
  CONSTRAINT_LIST
    0.d0 root
  /
END



TRANSPORT_CONDITION tide
  TYPE dirichlet
  TIME_UNITS hr
  CONSTRAINT_LIST
   0.d0 tide
  /
END



TRANSPORT_CONDITION O2_diffusion
  TYPE dirichlet
  TIME_UNITS hr
  CONSTRAINT_LIST
   0.d0 O2_diffusion
  /
END


#=========================== flow conditions =============================

FLOW_CONDITION initial
  TYPE
    GAS_PRESSURE dirichlet
    GAS_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 1.d5
  GAS_SATURATION 0.d0   
  TEMPERATURE 25.d0
/


FLOW_CONDITION sed_air_interface
  TYPE
    GAS_PRESSURE dirichlet
    GAS_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 1.d5
  GAS_SATURATION 0.d0   
  TEMPERATURE 25.d0
/



FLOW_CONDITION tide
  TYPE
    RATE volumetric_rate
  /
  RATE -0.0204d-4  0  0 m^3/hr m^3/hr MW

 skip
  RATE LIST
    EXTERNAL_FILE RateListTide_MI.txt


 
  TIME_UNITS hr
  DATA_UNITS m^3/hr   m^3/hr   MW
   0.d0   -0.0001   0.d0    0.d0
   2.d0    0.0001    0.d0   0.d0
  10.d0   -0.0001        0      0
 

 /
noskip 
/


FLOW_CONDITION O2_inj
  TYPE
    RATE volumetric_rate
   /
  
  RATE LIST
    TIME_UNITS hr
    DATA_UNITS m^3/hr   m^3/hr   MW
      
      0.d0   0.11111d-7   0.d0    0.d0   
      # 1.d-7 divided by number of roots; 
      #if injection from top, i.e., no heterogeneity of O2, then divided by the number of columns
  /
/


FLOW_CONDITION O2_diffusion
  TYPE
    RATE volumetric_rate
  /
  #RATE 0.0204d-7  0  0 m^3/hr m^3/hr MW

  RATE LIST
    EXTERNAL_FILE RateListO2_CB.txt
  /
  
/

#=========================== condition couplers ===============================
skip
SOURCE_SINK tide
  FLOW_CONDITION tide
  TRANSPORT_CONDITION tide
  REGION top
END
noskip


INITIAL_CONDITION     # initial condition
  TRANSPORT_CONDITION initial
  FLOW_CONDITION initial
  REGION all
END


BOUNDARY_CONDITION sed_air_interface
  TRANSPORT_CONDITION sed_air_interface
  FLOW_CONDITION sed_air_interface
  REGION top
END




skip
#O2 diffusion through the sediment-air interface, to simulate the oxygen fluctuation due to water table change,
#I have a list of O2 input rate wich varies with the water table over time in the FLOW CONDITION

SOURCE_SINK O2_diffusion            
  FLOW_CONDITION O2_diffusion
  TRANSPORT_CONDITION O2_diffusion
  REGION top
END
noskip



# set up flow conditions for plant-mediated transport of oxygen
SOURCE_SINK root1           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root1
END


SOURCE_SINK root2           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root2
END

SOURCE_SINK root3           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root3
END


SOURCE_SINK root4           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root4
END

SOURCE_SINK root5           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root5
END


SOURCE_SINK root6           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root6
END


SOURCE_SINK root7           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root7
END


SOURCE_SINK root8           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root8
END

SOURCE_SINK root9           
  FLOW_CONDITION O2_inj
  TRANSPORT_CONDITION root
  REGION root9
END



#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL soil1
END




#=========================== regression =======================================
REGRESSION
  CELL_IDS
    1
  /
END

END_SUBSURFACE


